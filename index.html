<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comish | Know Your Paycheck Before It Hits</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
:root{--bg:#000;--bg2:#0a0a0a;--card:#0d0d0d;--card2:#161616;--border:#262626;--text:#fff;--text2:#a3a3a3;--muted:#666;--accent:#00ff88;--accent2:#00cc6a;--glow:rgba(0,255,136,0.12);--blue:#3b82f6;--purple:#a855f7;--pink:#ec4899;--orange:#f97316;--yellow:#facc15}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Inter',-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;overflow-x:hidden}
a{color:inherit;text-decoration:none}
.gradient-bg{position:fixed;inset:0;background:radial-gradient(ellipse 80% 50% at 50% -20%,rgba(0,255,136,0.15),transparent),radial-gradient(ellipse 60% 40% at 100% 0%,rgba(59,130,246,0.1),transparent);pointer-events:none;z-index:0}
nav{position:fixed;top:0;left:0;right:0;z-index:100;padding:1rem 2rem;background:rgba(0,0,0,0.6);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,0.05)}
nav .container{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
.logo{font-size:1.5rem;font-weight:900;letter-spacing:-0.03em}
.logo span{color:var(--accent)}
nav .links{display:flex;gap:2.5rem;align-items:center}
nav .links a{color:var(--text2);font-size:0.9rem;font-weight:500;transition:color 0.2s}
nav .links a:hover{color:var(--text)}
.btn{display:inline-flex;align-items:center;justify-content:center;padding:0.875rem 1.75rem;border-radius:100px;font-weight:600;font-size:0.95rem;cursor:pointer;border:none;transition:all 0.3s;font-family:inherit}
.btn-primary{background:var(--accent);color:#000;box-shadow:0 0 30px rgba(0,255,136,0.3)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 0 50px rgba(0,255,136,0.5)}
.btn-secondary{background:rgba(255,255,255,0.05);color:var(--text);border:1px solid rgba(255,255,255,0.1)}
.btn-secondary:hover{background:rgba(255,255,255,0.1)}
.btn-ghost{background:transparent;color:var(--text2);padding:0.5rem 1rem}
.btn-ghost:hover{color:var(--text)}
.btn-lg{padding:1.125rem 2.5rem;font-size:1rem}
.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:8rem 2rem 4rem;position:relative;z-index:1}
.hero-content{max-width:900px;text-align:center}
.hero-badge{display:inline-flex;align-items:center;gap:0.5rem;background:rgba(0,255,136,0.1);border:1px solid rgba(0,255,136,0.2);color:var(--accent);padding:0.625rem 1.25rem;border-radius:100px;font-size:0.875rem;font-weight:600;margin-bottom:2rem;animation:pulse 3s ease-in-out infinite}
@keyframes pulse{0%,100%{box-shadow:0 0 20px rgba(0,255,136,0.2)}50%{box-shadow:0 0 40px rgba(0,255,136,0.4)}}
.hero h1{font-size:clamp(3rem,8vw,5.5rem);font-weight:900;line-height:1.05;letter-spacing:-0.03em;margin-bottom:1.5rem}
.hero h1 .gradient{background:linear-gradient(135deg,var(--accent) 0%,#00ffcc 50%,var(--blue) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero-sub{font-size:1.35rem;color:var(--text2);margin-bottom:2.5rem;max-width:650px;margin-left:auto;margin-right:auto;line-height:1.7}
.hero-buttons{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-bottom:3rem}
.social-proof{display:flex;align-items:center;justify-content:center;gap:1rem}
.proof-avatars{display:flex}
.avatar{width:40px;height:40px;border:2px solid var(--bg);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.85rem;font-weight:700;margin-left:-12px;color:#fff}
.avatar:first-child{margin-left:0}
.avatar:nth-child(1){background:linear-gradient(135deg,#3b82f6,#1d4ed8)}
.avatar:nth-child(2){background:linear-gradient(135deg,#a855f7,#7c3aed)}
.avatar:nth-child(3){background:linear-gradient(135deg,#ec4899,#db2777)}
.avatar:nth-child(4){background:linear-gradient(135deg,#f97316,#ea580c)}
.social-proof p{color:var(--text2);font-size:0.95rem}
.social-proof strong{color:var(--text)}
.ticker-section{padding:2rem 0;border-top:1px solid rgba(255,255,255,0.05);border-bottom:1px solid rgba(255,255,255,0.05);background:rgba(0,255,136,0.02);position:relative;z-index:1;overflow:hidden}
.ticker{display:flex;animation:ticker 30s linear infinite}
@keyframes ticker{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.ticker-item{display:flex;align-items:center;gap:0.75rem;padding:0 3rem;white-space:nowrap;color:var(--text2);font-size:0.9rem}
.ticker-item .amount{color:var(--accent);font-weight:700}
.section{padding:8rem 2rem;position:relative;z-index:1}
.section .container{max-width:1100px;margin:0 auto}
.section-label{text-align:center;color:var(--accent);font-size:0.85rem;font-weight:600;text-transform:uppercase;letter-spacing:0.1em;margin-bottom:1rem}
.section-title{text-align:center;font-size:3rem;font-weight:800;letter-spacing:-0.02em;margin-bottom:1rem}
.section-sub{text-align:center;color:var(--text2);font-size:1.2rem;margin-bottom:4rem}
.demo-window{background:var(--card);border:1px solid var(--border);border-radius:20px;overflow:hidden;box-shadow:0 20px 50px -10px rgba(0,0,0,0.5),0 0 100px rgba(0,255,136,0.1)}
.demo-header{background:linear-gradient(180deg,var(--card2),var(--card));padding:1rem 1.5rem;display:flex;align-items:center;gap:1rem;border-bottom:1px solid var(--border)}
.demo-dots{display:flex;gap:8px}
.demo-dots span{width:14px;height:14px;border-radius:50%}
.demo-dots span:nth-child(1){background:#ff5f57}
.demo-dots span:nth-child(2){background:#febc2e}
.demo-dots span:nth-child(3){background:#28c840}
.demo-content{padding:2rem}
.demo-grid{display:grid;grid-template-columns:1fr 1fr;gap:2rem}
@media(max-width:768px){.demo-grid{grid-template-columns:1fr}}
.demo-hero-stat{background:linear-gradient(135deg,rgba(0,255,136,0.1),rgba(0,255,136,0.02));border:1px solid rgba(0,255,136,0.2);border-radius:16px;padding:1.5rem;text-align:center;margin-bottom:1.5rem}
.demo-hero-stat .label{color:var(--accent);font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:0.1em}
.demo-hero-stat .value{font-size:3rem;font-weight:900;color:var(--accent);text-shadow:0 0 40px rgba(0,255,136,0.5)}
.demo-hero-stat .sub{color:var(--text2);font-size:0.9rem}
.demo-stats-row{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
.demo-stat{background:var(--card2);border:1px solid var(--border);border-radius:12px;padding:1rem;text-align:center}
.demo-stat .label{color:var(--muted);font-size:0.7rem;text-transform:uppercase}
.demo-stat .value{font-size:1.25rem;font-weight:700;margin-top:0.25rem}
.demo-stat .value.green{color:var(--accent)}.demo-stat .value.yellow{color:var(--yellow)}.demo-stat .value.blue{color:var(--blue)}
.demo-tiers{display:flex;flex-direction:column;gap:0.5rem}
.demo-tier{display:flex;align-items:center;padding:0.875rem 1rem;background:var(--card2);border:1px solid var(--border);border-radius:10px}
.demo-tier.active{background:rgba(0,255,136,0.08);border-color:rgba(0,255,136,0.3)}
.demo-tier.active .tier-comm{color:var(--accent)}
.tier-dot{width:10px;height:10px;border-radius:4px;margin-right:0.875rem}
.tier-dot.t1{background:var(--blue)}.tier-dot.t2{background:var(--purple)}.tier-dot.t3{background:var(--pink)}.tier-dot.t4{background:var(--orange)}
.tier-info{flex:1}
.tier-name{font-weight:600;font-size:0.85rem}
.tier-range{font-size:0.75rem;color:var(--muted)}
.tier-comm{font-size:0.95rem;font-weight:700;color:var(--text2)}
.pain-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem}
@media(max-width:768px){.pain-grid{grid-template-columns:1fr}}
.pain-card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:2rem;text-align:center;transition:all 0.3s}
.pain-card:hover{border-color:var(--border);transform:translateY(-4px)}
.pain-icon{font-size:3rem;margin-bottom:1rem}
.pain-card p{color:var(--text2);font-size:1.05rem;line-height:1.6}
.features-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem}
@media(max-width:900px){.features-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.features-grid{grid-template-columns:1fr}}
.feature-card{background:linear-gradient(180deg,var(--card2),var(--card));border:1px solid var(--border);border-radius:20px;padding:2rem;transition:all 0.3s}
.feature-card:hover{border-color:var(--accent);transform:translateY(-4px);box-shadow:0 20px 40px -20px rgba(0,255,136,0.2)}
.feature-icon{width:56px;height:56px;background:var(--glow);border:1px solid rgba(0,255,136,0.2);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.25rem}
.feature-card h3{font-size:1.2rem;font-weight:700;margin-bottom:0.5rem}
.feature-card p{color:var(--text2);font-size:0.95rem;line-height:1.6}
.steps{display:flex;flex-direction:column;gap:2rem}
.step{display:flex;gap:2rem;align-items:flex-start;background:var(--card);border:1px solid var(--border);border-radius:20px;padding:2rem;transition:all 0.3s}
.step:hover{border-color:var(--accent)}
.step-num{width:56px;height:56px;background:var(--accent);color:#000;border-radius:16px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1.5rem;flex-shrink:0}
.step-content h3{font-size:1.25rem;font-weight:700;margin-bottom:0.5rem}
.step-content p{color:var(--text2);font-size:1rem;line-height:1.6}
@media(max-width:600px){.step{flex-direction:column;align-items:center;text-align:center}}
.testimonials-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem}
@media(max-width:900px){.testimonials-grid{grid-template-columns:1fr}}
.testimonial-card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:2rem;display:flex;flex-direction:column}
.testimonial-stars{color:var(--yellow);font-size:1.1rem;margin-bottom:1rem}
.testimonial-quote{color:var(--text2);font-size:1rem;line-height:1.7;flex:1;margin-bottom:1.5rem}
.testimonial-author{display:flex;align-items:center;gap:1rem}
.testimonial-avatar{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.1rem;color:white}
.testimonial-card:nth-child(1) .testimonial-avatar{background:linear-gradient(135deg,var(--blue),#1d4ed8)}
.testimonial-card:nth-child(2) .testimonial-avatar{background:linear-gradient(135deg,var(--purple),#7c3aed)}
.testimonial-card:nth-child(3) .testimonial-avatar{background:linear-gradient(135deg,var(--pink),#db2777)}
.testimonial-info strong{display:block;font-size:0.95rem}
.testimonial-info span{color:var(--muted);font-size:0.85rem}
.pricing-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:2rem;max-width:900px;margin:0 auto}
@media(max-width:700px){.pricing-grid{grid-template-columns:1fr}}
.price-card{background:var(--card);border:1px solid var(--border);border-radius:24px;padding:2.5rem;position:relative}
.price-card.featured{border-color:var(--accent);box-shadow:0 0 60px rgba(0,255,136,0.15)}
.price-card.coming{opacity:0.6}
.price-badge{position:absolute;top:-14px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,var(--accent),var(--blue));color:#000;padding:0.5rem 1.25rem;border-radius:100px;font-size:0.8rem;font-weight:700}
.price-name{font-size:1.25rem;font-weight:600;margin-bottom:1rem;color:var(--text2)}
.price-amount{font-size:4rem;font-weight:900;letter-spacing:-0.03em;line-height:1}
.price-amount span{font-size:1.25rem;color:var(--muted);font-weight:500}
.price-period{color:var(--muted);font-size:0.9rem;margin-bottom:2rem}
.price-features{margin:0 0 2rem 0;padding:0;list-style:none}
.price-features li{display:flex;align-items:center;gap:0.875rem;padding:0.625rem 0;color:var(--text2);font-size:0.95rem}
.price-features li::before{content:'‚úì';color:var(--accent);font-weight:700}
.price-card .btn{width:100%}
.price-card .btn:disabled{opacity:0.4;cursor:not-allowed}
.cta-section{padding:10rem 2rem;position:relative;z-index:1;text-align:center}
.cta-section::before{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:600px;height:600px;background:radial-gradient(circle,rgba(0,255,136,0.15),transparent 70%);pointer-events:none}
.cta-content{max-width:700px;margin:0 auto;position:relative}
.cta-content h2{font-size:3.5rem;font-weight:900;letter-spacing:-0.03em;margin-bottom:1.5rem;line-height:1.1}
.cta-content p{color:var(--text2);font-size:1.25rem;margin-bottom:2.5rem}
.cta-note{margin-top:1.5rem;color:var(--muted);font-size:0.9rem}
footer{padding:4rem 2rem;border-top:1px solid var(--border);text-align:center;position:relative;z-index:1}
footer .logo{font-size:1.5rem;margin-bottom:1rem}
footer p{color:var(--muted);font-size:0.9rem}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.9);backdrop-filter:blur(10px);z-index:200;align-items:center;justify-content:center;padding:1rem}
.modal-overlay.active{display:flex}
.modal{background:var(--card);border:1px solid var(--border);border-radius:24px;width:100%;max-width:420px;overflow:hidden;box-shadow:0 25px 50px -12px rgba(0,0,0,0.5)}
.modal-header{padding:1.5rem 2rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.modal-header h2{font-size:1.25rem;font-weight:700}
.modal-close{background:none;border:none;color:var(--muted);font-size:1.5rem;cursor:pointer}
.modal-close:hover{color:var(--text)}
.modal-body{padding:2rem}
.form-group{margin-bottom:1.25rem}
.form-label{display:block;font-size:0.9rem;color:var(--text2);margin-bottom:0.5rem;font-weight:500}
.form-input{width:100%;background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:0.875rem 1rem;color:var(--text);font-size:1rem;font-family:inherit}
.form-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,255,136,0.1)}
.form-error{color:#ef4444;font-size:0.85rem;margin-top:0.5rem;display:none}
.form-error.show{display:block}
.auth-switch{text-align:center;margin-top:1.5rem;color:var(--text2);font-size:0.9rem}
.auth-switch a{color:var(--accent);cursor:pointer;font-weight:500}
#app{display:none}
#landing{display:block}
.hidden{display:none!important}
.onboarding{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem;position:relative;z-index:1}
.onboard-card{background:var(--card);border:1px solid var(--border);border-radius:24px;width:100%;max-width:500px;overflow:hidden}
.onboard-header{padding:2rem;border-bottom:1px solid var(--border)}
.onboard-header h2{font-size:1.5rem;font-weight:700;margin-bottom:0.25rem}
.onboard-header p{color:var(--text2)}
.onboard-progress{display:flex;gap:0.5rem;margin-top:1.5rem}
.onboard-progress .step{flex:1;height:4px;background:var(--border);border-radius:2px}
.onboard-progress .step.active,.onboard-progress .step.done{background:var(--accent)}
.onboard-body{padding:2rem}
.onboard-footer{padding:1.5rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:space-between}
.rate-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.75rem}
.rate-grid .form-input{text-align:center;padding:0.75rem 0.5rem}
.rate-label{font-size:0.7rem;color:var(--muted);text-align:center;margin-bottom:0.375rem;text-transform:uppercase}
.dashboard{min-height:100vh;background:var(--bg);position:relative;z-index:1}
.dash-nav{padding:1rem 2rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:rgba(0,0,0,0.8);backdrop-filter:blur(20px);position:sticky;top:0;z-index:50}
.user-menu{display:flex;align-items:center;gap:1rem}
.user-email{color:var(--text2);font-size:0.85rem}
.dash-container{max-width:1400px;margin:0 auto;padding:2rem}
.quick-entry{background:linear-gradient(135deg,var(--card),rgba(0,255,136,0.05));border:1px solid rgba(0,255,136,0.2);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:2rem;flex-wrap:wrap}
.quick-entry label{font-size:0.9rem;color:var(--text2)}
.quick-entry input{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:0.75rem;color:var(--text);font-size:1.25rem;width:180px}
.quick-entry input:focus{outline:none;border-color:var(--accent)}
.quick-entry .hint{font-size:0.75rem;color:var(--muted);margin-top:0.25rem}
.stats{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;margin-bottom:1.5rem}
@media(max-width:1200px){.stats{grid-template-columns:repeat(3,1fr)}}
@media(max-width:768px){.stats{grid-template-columns:repeat(2,1fr)}}
@media(max-width:480px){.stats{grid-template-columns:1fr}}
.stat{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.25rem}
.stat.hl{border-color:var(--accent);background:linear-gradient(135deg,var(--card),rgba(0,255,136,0.08))}
.stat-label{font-size:0.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.375rem}
.stat-value{font-size:1.375rem;font-weight:700}
.stat-sub{font-size:0.75rem;color:var(--text2);margin-top:0.25rem}
.green{color:var(--accent)}.yellow{color:var(--yellow)}.blue{color:var(--blue)}.purple{color:var(--purple)}
.progress-section{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem}
.progress-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
.progress-title{font-weight:600}
.progress-stats{display:flex;gap:2rem;font-size:0.9rem;color:var(--text2)}
.progress-stats strong{color:var(--text)}
.progress-bar-wrap{height:24px;background:var(--bg);border-radius:12px;overflow:hidden;margin-bottom:0.75rem}
.progress-bar{height:100%;background:linear-gradient(90deg,var(--blue),var(--purple),var(--pink),var(--orange));border-radius:12px;transition:width 0.5s}
.progress-labels{display:flex;justify-content:space-between;font-size:0.7rem;color:var(--muted)}
.main-grid{display:grid;grid-template-columns:1fr 400px;gap:1.5rem}
@media(max-width:1100px){.main-grid{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden}
.card-header{display:flex;justify-content:space-between;align-items:center;padding:1.25rem 1.5rem;border-bottom:1px solid var(--border)}
.card-title{font-weight:600}
.table-wrap{max-height:450px;overflow-y:auto}
table{width:100%;border-collapse:collapse}
th{text-align:left;padding:0.75rem 1rem;font-size:0.7rem;color:var(--muted);text-transform:uppercase;border-bottom:1px solid var(--border);position:sticky;top:0;background:var(--card)}
td{padding:0.875rem 1rem;border-bottom:1px solid var(--border);font-size:0.9rem}
tr:hover{background:var(--bg2)}
.badge{display:inline-flex;padding:0.25rem 0.625rem;border-radius:100px;font-size:0.75rem;font-weight:600}
.badge.y1{background:rgba(59,130,246,0.15);color:var(--blue)}
.badge.y2{background:rgba(168,85,247,0.15);color:var(--purple)}
.badge.paid{background:rgba(0,255,136,0.15);color:var(--accent)}
.badge.unpaid{background:rgba(250,204,21,0.15);color:var(--yellow)}
.deal-actions button{background:none;border:none;color:var(--muted);cursor:pointer;padding:0.375rem;font-size:1rem;border-radius:6px}
.deal-actions button:hover{color:var(--text);background:var(--bg2)}
.sidebar-cards{display:flex;flex-direction:column;gap:1.25rem}
.side-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.25rem}
.side-title{font-weight:600;margin-bottom:1rem;padding-bottom:0.75rem;border-bottom:1px solid var(--border)}
.tier-row{display:flex;align-items:center;padding:0.75rem;border-radius:10px;margin-bottom:0.375rem;background:var(--bg)}
.tier-row.active{background:rgba(0,255,136,0.1);border:1px solid rgba(0,255,136,0.2)}
.tier-color{width:10px;height:10px;border-radius:4px;margin-right:0.75rem}
.tier-info{flex:1}
.tier-name{font-weight:600;font-size:0.85rem}
.tier-range{font-size:0.75rem;color:var(--muted)}
.tier-amounts{text-align:right}
.tier-rev{font-size:0.75rem;color:var(--text2)}
.tier-comm{font-size:1rem;font-weight:700;color:var(--accent)}
.comm-summary{background:var(--bg);border-radius:12px;padding:1rem;margin-top:1rem}
.comm-row{display:flex;justify-content:space-between;padding:0.375rem 0;font-size:0.9rem}
.comm-row.total{border-top:1px solid var(--border);margin-top:0.75rem;padding-top:0.75rem;font-weight:600}
.comm-row.total .comm-value{color:var(--accent);font-size:1.1rem}
.comm-label{color:var(--text2)}
.comm-value{font-weight:600}
.empty{text-align:center;padding:4rem 2rem;color:var(--muted)}
.deal-modal .form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
.toggle-group{display:flex;background:var(--bg);border-radius:10px;padding:4px}
.toggle-opt{flex:1;padding:0.625rem;text-align:center;font-size:0.9rem;font-weight:500;cursor:pointer;border-radius:8px;color:var(--muted);transition:all 0.2s}
.toggle-opt.active{background:var(--card2);color:var(--text)}
.toggle-opt.y1.active{color:var(--blue)}
.toggle-opt.y2.active{color:var(--purple)}
.toast-wrap{position:fixed;bottom:2rem;right:2rem;z-index:300}
.toast{background:var(--card);border:1px solid var(--accent);border-radius:12px;padding:1rem 1.5rem;font-size:0.9rem;box-shadow:0 10px 40px rgba(0,0,0,0.3);animation:slideIn 0.3s}
@keyframes slideIn{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}
</style>
</head>
<body>
<div class="gradient-bg"></div>
<div id="landing">
<nav><div class="container"><div class="logo">Com<span>ish</span></div><div class="links"><a href="#features">Features</a><a href="#pricing">Pricing</a><button class="btn btn-ghost" onclick="showAuth('login')">Log in</button><button class="btn btn-primary" onclick="showAuth('signup')">Start Free</button></div></div></nav>
<section class="hero"><div class="hero-content">
<div class="hero-badge">‚ö° 2 minute setup. 14 days free. No card required.</div>
<h1>Know your paycheck<br><span class="gradient">before it hits.</span></h1>
<p class="hero-sub">Stop waiting until month end to find out what you made. See your exact commission on every deal, at every tier, in real time.</p>
<div class="hero-buttons"><button class="btn btn-primary btn-lg" onclick="showAuth('signup')">Start Tracking Free</button><button class="btn btn-secondary btn-lg" onclick="document.getElementById('demo').scrollIntoView({behavior:'smooth'})">See It In Action</button></div>
<div class="social-proof"><div class="proof-avatars"><div class="avatar">S</div><div class="avatar">M</div><div class="avatar">J</div><div class="avatar">A</div></div><p>Joined by <strong>500+ reps</strong> this month</p></div>
</div></section>
<section class="ticker-section"><div class="ticker">
<div class="ticker-item">üéØ Deal closed <span class="amount">$52,000</span></div>
<div class="ticker-item">üí∞ Commission earned <span class="amount">$4,680</span></div>
<div class="ticker-item">üìà Tier 3 unlocked <span class="amount">+2%</span></div>
<div class="ticker-item">üî• Monthly total <span class="amount">$127,500</span></div>
<div class="ticker-item">‚ú® Quarterly attainment <span class="amount">142%</span></div>
<div class="ticker-item">üéØ Deal closed <span class="amount">$52,000</span></div>
<div class="ticker-item">üí∞ Commission earned <span class="amount">$4,680</span></div>
<div class="ticker-item">üìà Tier 3 unlocked <span class="amount">+2%</span></div>
<div class="ticker-item">üî• Monthly total <span class="amount">$127,500</span></div>
<div class="ticker-item">‚ú® Quarterly attainment <span class="amount">142%</span></div>
</div></section>
<section class="section" id="demo"><div class="container">
<div class="section-label">See It In Action</div>
<h2 class="section-title">Your commission, crystal clear</h2>
<div class="demo-window"><div class="demo-header"><div class="demo-dots"><span></span><span></span><span></span></div><span style="flex:1;text-align:center;color:var(--muted);font-size:0.85rem">comish.app/dashboard</span><div style="width:60px"></div></div>
<div class="demo-content"><div class="demo-grid">
<div><div class="demo-hero-stat"><div class="label">Total Commission This Quarter</div><div class="value">$47,250</div><div class="sub">130% attainment ¬∑ Tier 3 active</div></div>
<div class="demo-stats-row"><div class="demo-stat"><div class="label">Revenue</div><div class="value">$487.5K</div></div><div class="demo-stat"><div class="label">To Tier 4</div><div class="value yellow">$75K</div></div><div class="demo-stat"><div class="label">This Month</div><div class="value blue">$142K</div></div></div></div>
<div><h3 style="font-size:0.9rem;font-weight:600;margin-bottom:1rem;color:var(--text2)">Commission by Tier</h3>
<div class="demo-tiers">
<div class="demo-tier active"><span class="tier-dot t1"></span><div class="tier-info"><div class="tier-name">Tier 1</div><div class="tier-range">$0 to $375K</div></div><span class="tier-comm">$22,500</span></div>
<div class="demo-tier active"><span class="tier-dot t2"></span><div class="tier-info"><div class="tier-name">Tier 2</div><div class="tier-range">$375K to $468K</div></div><span class="tier-comm">$9,375</span></div>
<div class="demo-tier active"><span class="tier-dot t3"></span><div class="tier-info"><div class="tier-name">Tier 3</div><div class="tier-range">$468K to $562K</div></div><span class="tier-comm">$15,375</span></div>
<div class="demo-tier"><span class="tier-dot t4"></span><div class="tier-info"><div class="tier-name">Tier 4</div><div class="tier-range">$562K+</div></div><span class="tier-comm">$0</span></div>
</div></div>
</div></div></div>
</div></section>
<section class="section"><div class="container">
<h2 class="section-title">Sound familiar?</h2>
<p class="section-sub">Yeah, we have been there too.</p>
<div class="pain-grid">
<div class="pain-card"><div class="pain-icon">üò§</div><p>"I have no idea what I am actually getting paid until the check hits my account."</p></div>
<div class="pain-card"><div class="pain-icon">ü§Ø</div><p>"My comp plan has so many tiers and accelerators, even finance gets the math wrong."</p></div>
<div class="pain-card"><div class="pain-icon">ü§∑</div><p>"Am I close to the next tier? How much is it worth? No clue."</p></div>
</div></div></section>
<section class="section" id="features"><div class="container">
<div class="section-label">Features</div>
<h2 class="section-title">Everything you need. Nothing you don't.</h2>
<div class="features-grid" style="margin-top:4rem">
<div class="feature-card"><div class="feature-icon">üíµ</div><h3>Exact dollar amounts</h3><p>Not percentages. Not estimates. The actual cash hitting your account after every deal.</p></div>
<div class="feature-card"><div class="feature-icon">üìä</div><h3>Tier by tier breakdown</h3><p>See exactly how much you earn at each commission tier. No more spreadsheet gymnastics.</p></div>
<div class="feature-card"><div class="feature-icon">üéØ</div><h3>Distance to next tier</h3><p>Know exactly how far you are from the next rate bump and what that bump is worth.</p></div>
<div class="feature-card"><div class="feature-icon">üìù</div><h3>Multi year contracts</h3><p>Different rates for 1 year vs 2 year deals? We calculate them separately, automatically.</p></div>
<div class="feature-card"><div class="feature-icon">‚ö°</div><h3>5 second deal entry</h3><p>Client name, amount, close date. Three fields. Done. Add deals between calls.</p></div>
<div class="feature-card"><div class="feature-icon">üì±</div><h3>Works everywhere</h3><p>Phone, tablet, laptop. Check your commission while you wait for your next meeting.</p></div>
</div></div></section>
<section class="section" style="background:linear-gradient(180deg,var(--bg),var(--bg2))"><div class="container" style="max-width:900px">
<h2 class="section-title">Zero to tracking in 2 minutes</h2>
<div class="steps" style="margin-top:4rem">
<div class="step"><div class="step-num">1</div><div class="step-content"><h3>Plug in your comp plan</h3><p>Quarterly goal, tier thresholds, commission rates. One time setup that takes 60 seconds.</p></div></div>
<div class="step"><div class="step-num">2</div><div class="step-content"><h3>Log your deals</h3><p>Add deals as you close them. Or enter your quarter to date total to get started instantly.</p></div></div>
<div class="step"><div class="step-num">3</div><div class="step-content"><h3>Know your money</h3><p>Watch your commission update in real time. Know exactly what you are taking home.</p></div></div>
</div></div></section>
<section class="section"><div class="container">
<h2 class="section-title">Reps love Comish</h2>
<div class="testimonials-grid" style="margin-top:4rem">
<div class="testimonial-card"><div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="testimonial-quote">"I used to spend hours every month trying to figure out my check. Now I know exactly where I stand after every call. Game changer."</p><div class="testimonial-author"><div class="testimonial-avatar">M</div><div class="testimonial-info"><strong>Mike R.</strong><span>Enterprise AE, SaaS</span></div></div></div>
<div class="testimonial-card"><div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="testimonial-quote">"Finally something that handles multi year deals correctly. My comp plan is complicated and Comish just gets it."</p><div class="testimonial-author"><div class="testimonial-avatar">S</div><div class="testimonial-info"><strong>Sarah K.</strong><span>Senior AE, Healthcare Tech</span></div></div></div>
<div class="testimonial-card"><div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="testimonial-quote">"Knowing how close I am to the next tier keeps me motivated. Closed two extra deals last month just to hit that bump."</p><div class="testimonial-author"><div class="testimonial-avatar">J</div><div class="testimonial-info"><strong>James T.</strong><span>Commercial AE, Fintech</span></div></div></div>
</div></div></section>
<section class="section" id="pricing" style="background:linear-gradient(180deg,var(--bg2),var(--bg))"><div class="container">
<h2 class="section-title">Simple pricing</h2>
<p class="section-sub">No surprises. Just like your commission should be.</p>
<div class="pricing-grid">
<div class="price-card featured"><div class="price-badge">Most Popular</div><div class="price-name">Pro</div><div class="price-amount">$12<span>/mo</span></div><div class="price-period">Billed monthly. Cancel anytime.</div>
<ul class="price-features"><li>Unlimited deals</li><li>Tiered commission calculation</li><li>1 year and 2 year rate support</li><li>Quarterly and monthly views</li><li>CSV export</li><li>Mobile friendly</li><li>14 day free trial</li></ul>
<button class="btn btn-primary btn-lg" onclick="showAuth('signup')">Start Free Trial</button></div>
<div class="price-card coming"><div class="price-badge" style="background:var(--purple)">Coming Soon</div><div class="price-name">Team</div><div class="price-amount">$49<span>/mo</span></div><div class="price-period">Up to 10 reps</div>
<ul class="price-features"><li>Everything in Pro</li><li>Team dashboard</li><li>Manager controls</li><li>Shared comp plans</li><li>Leaderboards</li><li>Priority support</li><li>Custom onboarding</li></ul>
<button class="btn btn-secondary btn-lg" disabled>Join Waitlist</button></div>
</div></div></section>
<section class="cta-section"><div class="cta-content">
<h2>Stop guessing.<br><span class="gradient">Start knowing.</span></h2>
<p>Set up takes 2 minutes. No credit card required. Know exactly what you are taking home.</p>
<button class="btn btn-primary btn-lg" onclick="showAuth('signup')">Start Tracking Free</button>
<p class="cta-note">Join 500+ sales reps who stopped guessing</p>
</div></section>
<footer><div class="logo">Com<span>ish</span></div><p>Built for sales reps, by sales reps.</p><p>¬© 2025 Comish. All rights reserved.</p></footer>
</div>
<div class="modal-overlay" id="authModal"><div class="modal"><div class="modal-header"><h2 id="authTitle">Sign Up</h2><button class="modal-close" onclick="hideAuth()">√ó</button></div><div class="modal-body">
<form id="authForm" onsubmit="handleAuth(event)">
<div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="authEmail" required placeholder="you@company.com"></div>
<div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="authPassword" required minlength="6" placeholder="At least 6 characters"></div>
<div class="form-error" id="authError"></div>
<button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:0.5rem" id="authSubmit">Sign Up</button>
</form>
<div class="auth-switch" id="authSwitch">Already have an account? <a onclick="toggleAuthMode()">Log in</a></div>
</div></div></div>
<div id="app">
<div id="onboarding" class="onboarding hidden"><div class="onboard-card">
<div class="onboard-header"><h2 id="onboardTitle">Set Your Quarterly Goal</h2><p id="onboardDesc">What is your quota for the quarter?</p>
<div class="onboard-progress"><div class="step active" id="ob-step-1"></div><div class="step" id="ob-step-2"></div><div class="step" id="ob-step-3"></div></div></div>
<div class="onboard-body">
<div id="ob-content-1"><div class="form-group"><label class="form-label">Quarterly Goal ($)</label><input type="number" class="form-input" id="obGoal" value="375000" style="font-size:1.5rem;text-align:center"></div></div>
<div id="ob-content-2" class="hidden"><div class="form-group"><label class="form-label">Tier Thresholds (% of goal)</label><div class="rate-grid"><div><div class="rate-label">Tier 1</div><input type="number" class="form-input" value="0" disabled></div><div><div class="rate-label">Tier 2</div><input type="number" class="form-input" id="obTh2" value="100"></div><div><div class="rate-label">Tier 3</div><input type="number" class="form-input" id="obTh3" value="125"></div><div><div class="rate-label">Tier 4</div><input type="number" class="form-input" id="obTh4" value="150"></div></div></div></div>
<div id="ob-content-3" class="hidden"><div class="form-group"><label class="form-label">1 Year Contract Rates (%)</label><div class="rate-grid"><div><div class="rate-label">Tier 1</div><input type="number" class="form-input" id="obR1a" value="6"></div><div><div class="rate-label">Tier 2</div><input type="number" class="form-input" id="obR1b" value="8"></div><div><div class="rate-label">Tier 3</div><input type="number" class="form-input" id="obR1c" value="10"></div><div><div class="rate-label">Tier 4</div><input type="number" class="form-input" id="obR1d" value="12"></div></div></div>
<div class="form-group" style="margin-top:1.5rem"><label class="form-label">2 Year Contract Rates (%)</label><div class="rate-grid"><div><div class="rate-label">Tier 1</div><input type="number" class="form-input" id="obR2a" value="8"></div><div><div class="rate-label">Tier 2</div><input type="number" class="form-input" id="obR2b" value="10"></div><div><div class="rate-label">Tier 3</div><input type="number" class="form-input" id="obR2c" value="12"></div><div><div class="rate-label">Tier 4</div><input type="number" class="form-input" id="obR2d" value="14"></div></div></div></div>
</div>
<div class="onboard-footer"><button class="btn btn-ghost" id="obBack" onclick="onboardBack()" style="visibility:hidden">Back</button><button class="btn btn-primary" id="obNext" onclick="onboardNext()">Next</button></div>
</div></div>
<div id="dashboard" class="dashboard hidden">
<nav class="dash-nav"><div class="logo">Com<span>ish</span></div><div class="user-menu"><span class="user-email" id="userEmail"></span><button class="btn btn-ghost" onclick="logout()">Log out</button></div></nav>
<div class="dash-container">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem">
<div style="display:flex;gap:0.75rem"><select id="yearSelect" onchange="render()" style="background:var(--card);border:1px solid var(--border);border-radius:10px;padding:0.625rem 1rem;color:var(--text)"></select><select id="quarterSelect" onchange="render()" style="background:var(--card);border:1px solid var(--border);border-radius:10px;padding:0.625rem 1rem;color:var(--text)"><option value="Q1">Q1</option><option value="Q2">Q2</option><option value="Q3">Q3</option><option value="Q4">Q4</option></select></div>
<div style="display:flex;gap:0.75rem"><button class="btn btn-secondary" onclick="exportCSV()">üì§ Export</button><button class="btn btn-secondary" onclick="openSettings()">‚öôÔ∏è Settings</button><button class="btn btn-primary" onclick="openDeal()">+ Add Deal</button></div>
</div>
<div class="quick-entry">
<div><label>Starting Point</label><div style="display:flex;gap:0.5rem;align-items:center;margin-top:0.375rem"><span style="color:var(--muted);font-size:1.25rem">$</span><input type="number" id="startingPoint" placeholder="0" onchange="saveStarting()"></div><div class="hint">Revenue already closed this quarter before tracking</div></div>
<div style="margin-left:auto;text-align:right"><div style="font-size:0.75rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em">Quarterly Total</div><div style="font-size:2rem;font-weight:900;color:var(--accent)" id="qtdTotal">$0</div></div>
</div>
<div class="stats">
<div class="stat"><div class="stat-label">Quarterly Goal</div><div class="stat-value" id="qGoal">$375,000</div><div class="stat-sub" id="attainmentPct">0%</div></div>
<div class="stat"><div class="stat-label">Current Tier</div><div class="stat-value green" id="currentTier">Tier 1</div><div class="stat-sub" id="tierRates">1yr: 6% ¬∑ 2yr: 8%</div></div>
<div class="stat"><div class="stat-label">To Next Tier</div><div class="stat-value yellow" id="toNext">$375,000</div><div class="stat-sub" id="nextTierName">to Tier 2</div></div>
<div class="stat"><div class="stat-label">This Month</div><div class="stat-value blue" id="monthTotal">$0</div><div class="stat-sub" id="monthDeals">0 deals</div></div>
<div class="stat hl"><div class="stat-label">Total Commission</div><div class="stat-value green" id="totalCommStat">$0</div><div class="stat-sub">blended across tiers</div></div>
</div>
<div class="progress-section">
<div class="progress-header"><span class="progress-title">Quarterly Progress</span><div class="progress-stats"><span><strong id="closedAmt">$0</strong> closed</span><span><strong id="remainingAmt">$375K</strong> to goal</span></div></div>
<div class="progress-bar-wrap"><div class="progress-bar" id="progressBar" style="width:0%"></div></div>
<div class="progress-labels"><span>0%</span><span>100%</span><span>125%</span><span>150%</span><span>175%+</span></div>
</div>
<div class="main-grid">
<div class="card"><div class="card-header"><span class="card-title">Deals</span><select id="monthFilter" onchange="renderDeals()" style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:0.5rem 0.75rem;color:var(--text)"><option value="all">All Months</option></select></div>
<div class="table-wrap"><table><thead><tr><th>Client</th><th>Amount</th><th>Term</th><th>Date</th><th>Status</th><th></th></tr></thead><tbody id="dealsBody"></tbody></table><div class="empty" id="emptyDeals" style="display:none">No deals yet.<br><button class="btn btn-primary" onclick="openDeal()" style="margin-top:1rem">Add your first deal</button></div></div></div>
<div class="sidebar-cards">
<div class="side-card"><div class="side-title">Commission by Tier</div><div id="tierBreakdown"></div><div class="comm-summary"><div class="comm-row"><span class="comm-label">1 Year Deals</span><span class="comm-value blue" id="y1Comm">$0</span></div><div class="comm-row"><span class="comm-label">2 Year Deals</span><span class="comm-value purple" id="y2Comm">$0</span></div><div class="comm-row total"><span class="comm-label">Total</span><span class="comm-value" id="totalComm">$0</span></div></div></div>
<div class="side-card"><div class="side-title">Revenue</div><div class="comm-row"><span class="comm-label">1 Year</span><span class="comm-value blue" id="y1Rev">$0</span></div><div class="comm-row"><span class="comm-label">2 Year</span><span class="comm-value purple" id="y2Rev">$0</span></div><div class="comm-row total"><span class="comm-label">Deals Total</span><span class="comm-value" id="totalRev">$0</span></div></div>
</div></div></div></div></div>
<div class="modal-overlay deal-modal" id="dealModal"><div class="modal"><div class="modal-header"><h2 id="dealModalTitle">Add Deal</h2><button class="modal-close" onclick="closeDeal()">√ó</button></div><div class="modal-body"><input type="hidden" id="editId">
<div class="form-group"><label class="form-label">Client Name</label><input type="text" class="form-input" id="dealName" placeholder="Acme Corp"></div>
<div class="form-row"><div class="form-group"><label class="form-label">Amount ($)</label><input type="number" class="form-input" id="dealAmt" placeholder="50000"></div><div class="form-group"><label class="form-label">Close Date</label><input type="date" class="form-input" id="dealDate"></div></div>
<div class="form-group"><label class="form-label">Contract Length</label><div class="toggle-group"><div class="toggle-opt y1 active" onclick="setTerm(1)">1 Year</div><div class="toggle-opt y2" onclick="setTerm(2)">2 Year</div></div><input type="hidden" id="dealTerm" value="1"></div>
<div class="form-group"><label class="form-label">Payment Status</label><div class="toggle-group"><div class="toggle-opt active" onclick="setPaid(false)" id="unpaidOpt">Unpaid</div><div class="toggle-opt" onclick="setPaid(true)" id="paidOpt">Paid</div></div><input type="hidden" id="dealPaid" value="false"></div>
</div><div style="padding:1.25rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:0.75rem"><button class="btn btn-secondary" onclick="closeDeal()">Cancel</button><button class="btn btn-primary" onclick="saveDeal()">Save Deal</button></div></div></div>
<div class="modal-overlay" id="settingsModal"><div class="modal"><div class="modal-header"><h2>Settings</h2><button class="modal-close" onclick="closeSettings()">√ó</button></div><div class="modal-body">
<div class="form-group"><label class="form-label">Quarterly Goal ($)</label><input type="number" class="form-input" id="setGoal"></div>
<div class="form-group"><label class="form-label">Tier Thresholds (%)</label><div class="rate-grid"><div><div class="rate-label">T1</div><input type="number" class="form-input" value="0" disabled></div><div><div class="rate-label">T2</div><input type="number" class="form-input" id="setTh2"></div><div><div class="rate-label">T3</div><input type="number" class="form-input" id="setTh3"></div><div><div class="rate-label">T4</div><input type="number" class="form-input" id="setTh4"></div></div></div>
<div class="form-group"><label class="form-label">1 Year Rates (%)</label><div class="rate-grid"><input type="number" class="form-input" id="setR1a"><input type="number" class="form-input" id="setR1b"><input type="number" class="form-input" id="setR1c"><input type="number" class="form-input" id="setR1d"></div></div>
<div class="form-group"><label class="form-label">2 Year Rates (%)</label><div class="rate-grid"><input type="number" class="form-input" id="setR2a"><input type="number" class="form-input" id="setR2b"><input type="number" class="form-input" id="setR2c"><input type="number" class="form-input" id="setR2d"></div></div>
</div><div style="padding:1.25rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:0.75rem"><button class="btn btn-secondary" onclick="closeSettings()">Cancel</button><button class="btn btn-primary" onclick="saveSettings()">Save</button></div></div></div>
<div class="toast-wrap" id="toasts"></div>
<script>
const SUPABASE_URL='https://yeecmrjkkujtsvrtatig.supabase.co';
const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InllZWNtcmpra3VqdHN2cnRhdGxnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMTA5MzMsImV4cCI6MjA4MDc4NjkzM30.bKr372_-0v2yVGkDFJ87ys5gxQN6qzS5smLLvPmrar0';
let supabase,user=null,compPlan=null,deals=[],startingPoints={};
const $=id=>document.getElementById(id);
const fmt=n=>new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',minimumFractionDigits:0,maximumFractionDigits:0}).format(n||0);
function toast(m){const t=document.createElement('div');t.className='toast';t.textContent=m;$('toasts').appendChild(t);setTimeout(()=>t.remove(),3000)}
let authMode='signup';
function showAuth(m){authMode=m;$('authModal').classList.add('active');$('authTitle').textContent=m==='signup'?'Create Account':'Welcome Back';$('authSubmit').textContent=m==='signup'?'Create Account':'Log In';$('authSwitch').innerHTML=m==='signup'?'Already have an account? <a onclick="toggleAuthMode()">Log in</a>':'Need an account? <a onclick="toggleAuthMode()">Sign up</a>';$('authError').classList.remove('show')}
function hideAuth(){$('authModal').classList.remove('active')}
function toggleAuthMode(){showAuth(authMode==='signup'?'login':'signup')}
async function handleAuth(e){e.preventDefault();const email=$('authEmail').value,pw=$('authPassword').value;$('authSubmit').disabled=true;$('authSubmit').textContent='Please wait...';$('authError').classList.remove('show');try{let r;if(authMode==='signup')r=await supabase.auth.signUp({email,password:pw});else r=await supabase.auth.signInWithPassword({email,password:pw});if(r.error)throw r.error;hideAuth()}catch(e){$('authError').textContent=e.message;$('authError').classList.add('show')}finally{$('authSubmit').disabled=false;$('authSubmit').textContent=authMode==='signup'?'Create Account':'Log In'}}
async function logout(){await supabase.auth.signOut();user=null;compPlan=null;deals=[];$('app').style.display='none';$('landing').style.display='block'}
let onboardStep=1;
function showOnboarding(){$('onboarding').classList.remove('hidden');$('dashboard').classList.add('hidden');onboardStep=1;updateOnboardUI()}
function updateOnboardUI(){for(let i=1;i<=3;i++){$(`ob-step-${i}`).className='step'+(i<onboardStep?' done':i===onboardStep?' active':'');$(`ob-content-${i}`).classList.toggle('hidden',i!==onboardStep)}$('obBack').style.visibility=onboardStep===1?'hidden':'visible';$('obNext').textContent=onboardStep===3?'Finish Setup':'Continue';const t=['Set Your Quarterly Goal','Configure Tier Thresholds','Set Commission Rates'],d=["What is your quota for the quarter?",'At what % of goal do you hit each tier?','What % do you earn at each tier?'];$('onboardTitle').textContent=t[onboardStep-1];$('onboardDesc').textContent=d[onboardStep-1]}
function onboardBack(){if(onboardStep>1){onboardStep--;updateOnboardUI()}}
async function onboardNext(){if(onboardStep<3){onboardStep++;updateOnboardUI()}else{const plan={user_id:user.id,quarterly_goal:parseFloat($('obGoal').value)||375000,tiers:JSON.stringify([0,parseFloat($('obTh2').value)||100,parseFloat($('obTh3').value)||125,parseFloat($('obTh4').value)||150]),rates_1yr:JSON.stringify([parseFloat($('obR1a').value)||6,parseFloat($('obR1b').value)||8,parseFloat($('obR1c').value)||10,parseFloat($('obR1d').value)||12]),rates_2yr:JSON.stringify([parseFloat($('obR2a').value)||8,parseFloat($('obR2b').value)||10,parseFloat($('obR2c').value)||12,parseFloat($('obR2d').value)||14])};const{data,error}=await supabase.from('comp_plans').insert(plan).select().single();if(error){toast('Error: '+error.message);return}await supabase.from('profiles').update({onboarded:true}).eq('id',user.id);compPlan=data;compPlan.tiers=JSON.parse(compPlan.tiers);compPlan.rates_1yr=JSON.parse(compPlan.rates_1yr);compPlan.rates_2yr=JSON.parse(compPlan.rates_2yr);showDashboard();toast('Setup complete!')}}
function showDashboard(){$('onboarding').classList.add('hidden');$('dashboard').classList.remove('hidden');$('userEmail').textContent=user.email;initYear();$('quarterSelect').value=curQ();render()}
function curQ(){const m=new Date().getMonth();return m<3?'Q1':m<6?'Q2':m<9?'Q3':'Q4'}
function curY(){return new Date().getFullYear()}
function curM(){return new Date().getMonth()}
function getQ(d){const m=new Date(d+'T00:00:00').getMonth();return m<3?'Q1':m<6?'Q2':m<9?'Q3':'Q4'}
function getM(d){return new Date(d+'T00:00:00').getMonth()}
function getY(d){return new Date(d+'T00:00:00').getFullYear()}
function fmtD(d){return new Date(d+'T00:00:00').toLocaleDateString('en-US',{month:'short',day:'numeric'})}
function qKey(){return $('yearSelect').value+'-'+$('quarterSelect').value}
function qMonths(q){return q==='Q1'?[0,1,2]:q==='Q2'?[3,4,5]:q==='Q3'?[6,7,8]:[9,10,11]}
function mName(m){return['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][m]}
function initYear(){const s=$('yearSelect'),y=new Set([curY()]);deals.forEach(d=>{if(d.close_date)y.add(getY(d.close_date))});s.innerHTML=[...y].sort((a,b)=>b-a).map(yr=>`<option>${yr}</option>`).join('')}
async function saveStarting(){const k=qKey(),a=parseFloat($('startingPoint').value)||0;startingPoints[k]=a;await supabase.from('starting_points').upsert({user_id:user.id,comp_plan_id:compPlan.id,quarter:k,amount:a},{onConflict:'user_id,comp_plan_id,quarter'});render()}
function filtered(){const y=+$('yearSelect').value,q=$('quarterSelect').value;return deals.filter(d=>d.close_date&&getY(d.close_date)===y&&getQ(d.close_date)===q)}
function calcComm(deals,start){const goal=compPlan.quarterly_goal,tiers=compPlan.tiers,r1=compPlan.rates_1yr,r2=compPlan.rates_2yr,total=start+deals.reduce((s,d)=>s+d.amount,0),y1=deals.filter(d=>d.term===1),y2=deals.filter(d=>d.term===2),y1Tot=y1.reduce((s,d)=>s+d.amount,0),y2Tot=y2.reduce((s,d)=>s+d.amount,0),dTot=y1Tot+y2Tot,tierData=[];let y1C=0,y2C=0;for(let i=0;i<tiers.length;i++){const tS=tiers[i]/100*goal,tE=i<tiers.length-1?tiers[i+1]/100*goal:Infinity,revIn=Math.max(0,Math.min(total,tE)-tS);if(revIn<=0){tierData.push({tier:i+1,rev:0,comm:0,start:tS,end:tE});continue}const startIn=Math.max(0,Math.min(start,tE)-tS),dealsIn=revIn-startIn;let y1In=0,y2In=0;if(dTot>0&&dealsIn>0){y1In=dealsIn*(y1Tot/dTot);y2In=dealsIn*(y2Tot/dTot)}const y1Cm=y1In*r1[i]/100,y2Cm=y2In*r2[i]/100,avgR=(r1[i]+r2[i])/2,startCm=startIn*avgR/100;y1C+=y1Cm;y2C+=y2Cm;tierData.push({tier:i+1,rev:revIn,y1:y1In,y2:y2In,comm:y1Cm+y2Cm+startCm,start:tS,end:tE})}return{y1C,y2C,total:tierData.reduce((s,t)=>s+t.comm,0),tierData,y1Tot,y2Tot}}
function render(){const goal=compPlan.quarterly_goal,tiers=compPlan.tiers,r1=compPlan.rates_1yr,r2=compPlan.rates_2yr,start=startingPoints[qKey()]||0;$('startingPoint').value=start||'';const d=filtered(),dTot=d.reduce((s,x)=>s+x.amount,0),qtd=start+dTot,pct=qtd/goal*100;let tier=0;for(let i=tiers.length-1;i>=0;i--)if(pct>=tiers[i]){tier=i;break}const c=calcComm(d,start);$('qtdTotal').textContent=fmt(qtd);$('qGoal').textContent=fmt(goal);$('attainmentPct').textContent=pct.toFixed(1)+'%';$('currentTier').textContent='Tier '+(tier+1);$('tierRates').textContent=`1yr: ${r1[tier]}% ¬∑ 2yr: ${r2[tier]}%`;const nx=tier+1;if(nx<tiers.length){$('toNext').textContent=fmt(Math.max(0,tiers[nx]/100*goal-qtd));$('nextTierName').textContent='to Tier '+(nx+1)}else{$('toNext').textContent='Max!';$('nextTierName').textContent=''}const mD=d.filter(x=>getM(x.close_date)===curM()&&getY(x.close_date)===curY());$('monthTotal').textContent=fmt(mD.reduce((s,x)=>s+x.amount,0));$('monthDeals').textContent=mD.length+' deal'+(mD.length!==1?'s':'');$('progressBar').style.width=Math.min(100,pct/175*100)+'%';$('closedAmt').textContent=fmt(qtd);$('remainingAmt').textContent=fmt(Math.max(0,goal-qtd));let bH='';for(const t of c.tierData){const a=t.rev>0,eD=t.end===Infinity?'‚àû':fmt(t.end);bH+=`<div class="tier-row ${a?'active':''}"><span class="tier-color" style="background:var(--${['blue','purple','pink','orange'][t.tier-1]})"></span><div class="tier-info"><div class="tier-name">Tier ${t.tier} (${r1[t.tier-1]}%/${r2[t.tier-1]}%)</div><div class="tier-range">${fmt(t.start)} to ${eD}</div></div><div class="tier-amounts"><div class="tier-rev">${fmt(t.rev)}</div><div class="tier-comm">${fmt(t.comm)}</div></div></div>`}$('tierBreakdown').innerHTML=bH;$('y1Comm').textContent=fmt(c.y1C);$('y2Comm').textContent=fmt(c.y2C);$('totalComm').textContent=fmt(c.total);$('totalCommStat').textContent=fmt(c.total);$('y1Rev').textContent=fmt(c.y1Tot);$('y2Rev').textContent=fmt(c.y2Tot);$('totalRev').textContent=fmt(dTot);const qM=qMonths($('quarterSelect').value),mf=$('monthFilter'),cv=mf.value;mf.innerHTML='<option value="all">All Months</option>'+qM.map(m=>`<option value="${m}">${mName(m)}</option>`).join('');mf.value=cv;renderDeals()}
function renderDeals(){let d=filtered();const mf=$('monthFilter').value;if(mf!=='all')d=d.filter(x=>getM(x.close_date)===+mf);d.sort((a,b)=>new Date(b.close_date)-new Date(a.close_date));const tb=$('dealsBody'),em=$('emptyDeals');if(!d.length){tb.innerHTML='';em.style.display='block';return}em.style.display='none';tb.innerHTML=d.map(x=>`<tr><td style="font-weight:500">${x.name}</td><td style="font-weight:600">${fmt(x.amount)}</td><td><span class="badge ${x.term===2?'y2':'y1'}">${x.term}yr</span></td><td style="color:var(--text2)">${fmtD(x.close_date)}</td><td><span class="badge ${x.paid?'paid':'unpaid'}">${x.paid?'Paid':'Unpaid'}</span></td><td class="deal-actions">${!x.paid?`<button onclick="markPaid('${x.id}')">üí∞</button>`:''}<button onclick="editDeal('${x.id}')">‚úé</button><button onclick="delDeal('${x.id}')">√ó</button></td></tr>`).join('')}
function setTerm(t){$('dealTerm').value=t;document.querySelectorAll('.toggle-opt.y1,.toggle-opt.y2').forEach(e=>e.classList.remove('active'));document.querySelector(`.toggle-opt.y${t}`).classList.add('active')}
function setPaid(p){$('dealPaid').value=p;$('paidOpt').classList.toggle('active',p);$('unpaidOpt').classList.toggle('active',!p)}
function openDeal(id){$('dealModal').classList.add('active');$('dealModalTitle').textContent=id?'Edit Deal':'Add Deal';$('editId').value=id||'';if(id){const d=deals.find(x=>x.id===id);if(d){$('dealName').value=d.name;$('dealAmt').value=d.amount;$('dealDate').value=d.close_date;setTerm(d.term||1);setPaid(d.paid||false)}}else{$('dealName').value='';$('dealAmt').value='';$('dealDate').value=new Date().toISOString().split('T')[0];setTerm(1);setPaid(false)}}
function closeDeal(){$('dealModal').classList.remove('active')}
async function saveDeal(){const n=$('dealName').value.trim(),a=parseFloat($('dealAmt').value),dt=$('dealDate').value,tm=+$('dealTerm').value,pd=$('dealPaid').value==='true',eid=$('editId').value;if(!n||isNaN(a)||!dt){toast('Fill all fields');return}if(eid){const{error}=await supabase.from('deals').update({name:n,amount:a,close_date:dt,term:tm,paid:pd}).eq('id',eid);if(error){toast('Error: '+error.message);return}const d=deals.find(x=>x.id===eid);if(d){d.name=n;d.amount=a;d.close_date=dt;d.term=tm;d.paid=pd}toast('Updated')}else{const{data,error}=await supabase.from('deals').insert({user_id:user.id,comp_plan_id:compPlan.id,name:n,amount:a,close_date:dt,term:tm,paid:pd}).select().single();if(error){toast('Error: '+error.message);return}deals.push(data);toast('Deal added')}closeDeal();initYear();render()}
function editDeal(id){openDeal(id)}
async function delDeal(id){if(!confirm('Delete this deal?'))return;const{error}=await supabase.from('deals').delete().eq('id',id);if(error){toast('Error: '+error.message);return}deals=deals.filter(d=>d.id!==id);render();toast('Deleted')}
async function markPaid(id){const{error}=await supabase.from('deals').update({paid:true}).eq('id',id);if(error){toast('Error: '+error.message);return}const d=deals.find(x=>x.id===id);if(d)d.paid=true;render();toast('Marked paid')}
function openSettings(){$('settingsModal').classList.add('active');$('setGoal').value=compPlan.quarterly_goal;$('setTh2').value=compPlan.tiers[1];$('setTh3').value=compPlan.tiers[2];$('setTh4').value=compPlan.tiers[3];$('setR1a').value=compPlan.rates_1yr[0];$('setR1b').value=compPlan.rates_1yr[1];$('setR1c').value=compPlan.rates_1yr[2];$('setR1d').value=compPlan.rates_1yr[3];$('setR2a').value=compPlan.rates_2yr[0];$('setR2b').value=compPlan.rates_2yr[1];$('setR2c').value=compPlan.rates_2yr[2];$('setR2d').value=compPlan.rates_2yr[3]}
function closeSettings(){$('settingsModal').classList.remove('active')}
async function saveSettings(){const u={quarterly_goal:+$('setGoal').value||375000,tiers:JSON.stringify([0,+$('setTh2').value||100,+$('setTh3').value||125,+$('setTh4').value||150]),rates_1yr:JSON.stringify([+$('setR1a').value||6,+$('setR1b').value||8,+$('setR1c').value||10,+$('setR1d').value||12]),rates_2yr:JSON.stringify([+$('setR2a').value||8,+$('setR2b').value||10,+$('setR2c').value||12,+$('setR2d').value||14])};const{error}=await supabase.from('comp_plans').update(u).eq('id',compPlan.id);if(error){toast('Error: '+error.message);return}compPlan.quarterly_goal=u.quarterly_goal;compPlan.tiers=JSON.parse(u.tiers);compPlan.rates_1yr=JSON.parse(u.rates_1yr);compPlan.rates_2yr=JSON.parse(u.rates_2yr);closeSettings();render();toast('Settings saved')}
function exportCSV(){if(!deals.length){toast('No deals to export');return}let c='Name,Amount,Date,Term,Paid\n';deals.forEach(d=>{c+=`"${d.name}",${d.amount},${d.close_date},${d.term}yr,${d.paid?'Y':'N'}\n`});const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([c],{type:'text/csv'}));a.download='comish-deals.csv';a.click();toast('Exported')}
async function init(){supabase=window.supabase.createClient(SUPABASE_URL,SUPABASE_KEY);const{data:{session}}=await supabase.auth.getSession();if(session)await loadUser(session.user);supabase.auth.onAuthStateChange(async(e,s)=>{if(e==='SIGNED_IN'&&s)await loadUser(s.user)})}
async function loadUser(u){user=u;$('landing').style.display='none';$('app').style.display='block';const{data:profile}=await supabase.from('profiles').select('*').eq('id',user.id).single();if(!profile||!profile.onboarded){showOnboarding();return}const{data:plans}=await supabase.from('comp_plans').select('*').eq('user_id',user.id);if(plans&&plans.length){compPlan=plans[0];compPlan.tiers=JSON.parse(compPlan.tiers);compPlan.rates_1yr=JSON.parse(compPlan.rates_1yr);compPlan.rates_2yr=JSON.parse(compPlan.rates_2yr)}const{data:d}=await supabase.from('deals').select('*').eq('user_id',user.id);deals=d||[];const{data:sp}=await supabase.from('starting_points').select('*').eq('user_id',user.id);if(sp)sp.forEach(s=>{startingPoints[s.quarter]=s.amount});showDashboard()}
init();
</script>
</body>
</html>
